{"version":3,"sources":["webpack:///client.2a8855fd.js","webpack:///./src/utils.js","webpack:///./example/index.js","webpack:///./src/zoom-image.js","webpack:///./src/zoom.js"],"names":["webpackJsonp","module","exports","__webpack_require__","Object","defineProperty","value","windowWidth","document","documentElement","clientWidth","windowHeight","clientHeight","elemOffset","elem","rect","getBoundingClientRect","docElem","win","window","top","pageYOffset","clientTop","left","pageXOffset","clientLeft","once","type","handler","fn","e","target","removeEventListener","addEventListener","_interopRequireDefault","obj","__esModule","default","_classCallCheck","instance","Constructor","TypeError","_possibleConstructorReturn","self","call","ReferenceError","_inherits","subClass","superClass","prototype","create","constructor","enumerable","writable","configurable","setPrototypeOf","__proto__","_createClass","defineProperties","props","i","length","descriptor","key","protoProps","staticProps","_preact","_zoom","_zoom2","App","_Component","this","getPrototypeOf","apply","arguments","img","_this2","h","class","width","ref","src","Component","render","body","_utils","Size","w","ZoomImage","offset","preservedTransform","style","transform","wrap","overlay","offsetWidth","size","naturalWidth","naturalHeight","createElement","classList","add","parentNode","insertBefore","appendChild","setAttribute","forceRepaint","scale","calculateScale","animate","maxScaleFactor","viewportWidth","viewportHeight","imageAspectRatio","viewportAspectRatio","imageOffset","scrollTop","viewportX","viewportY","imageCenterX","imageCenterY","height","tx","ty","tz","imgTr","wrapTr","remove","removeChild","_this","removeAttribute","dispose","handleScroll","initialScrollPos","deltaY","Math","abs","closeCurrent","handleKeyup","keyCode","handleTouchStart","t","touches","initialTouchPos","pageY","handleTouchMove","handleClick","addCloseListeners","removeCloseListeners","force","current","close","prepareZoom","contains","metaKey","ctrlKey","open","getAttribute","_zoomImage2","zoom","el","_zoomImage"],"mappings":"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","file":"client.2a8855fd.js","sourcesContent":["webpackJsonp([0,2],[\n/* 0 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nvar windowWidth = function windowWidth() {\n  return document.documentElement.clientWidth;\n};\nvar windowHeight = function windowHeight() {\n  return document.documentElement.clientHeight;\n};\n\nvar elemOffset = function elemOffset(elem) {\n  var rect = elem.getBoundingClientRect();\n  var docElem = document.documentElement;\n  var win = window;\n  return {\n    top: rect.top + win.pageYOffset - docElem.clientTop,\n    left: rect.left + win.pageXOffset - docElem.clientLeft\n  };\n};\n\nvar once = function once(elem, type, handler) {\n  var fn = function fn(e) {\n    e.target.removeEventListener(type, fn);\n    handler();\n  };\n  elem.addEventListener(type, fn);\n};\n\nexports.windowWidth = windowWidth;\nexports.windowHeight = windowHeight;\nexports.elemOffset = elemOffset;\nexports.once = once;\n\n/***/ }),\n/* 1 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _preact = __webpack_require__(6);\n\nvar _zoom = __webpack_require__(3);\n\nvar _zoom2 = _interopRequireDefault(_zoom);\n\n__webpack_require__(4);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar App = function (_Component) {\n  _inherits(App, _Component);\n\n  function App() {\n    _classCallCheck(this, App);\n\n    return _possibleConstructorReturn(this, (App.__proto__ || Object.getPrototypeOf(App)).apply(this, arguments));\n  }\n\n  _createClass(App, [{\n    key: 'componentDidMount',\n    value: function componentDidMount() {\n      (0, _zoom2.default)(this.img);\n    }\n  }, {\n    key: 'render',\n    value: function render() {\n      var _this2 = this;\n\n      return (0, _preact.h)(\n        'div',\n        { 'class': 'app' },\n        (0, _preact.h)(\n          'h1',\n          null,\n          'Just tap the image!'\n        ),\n        (0, _preact.h)('img', { width: '200', ref: function ref(img) {\n            return _this2.img = img;\n          }, src: 'https://ooo.0o0.ooo/2017/02/11/589ecad7083f4.png' })\n      );\n    }\n  }]);\n\n  return App;\n}(_preact.Component);\n\n(0, _preact.render)((0, _preact.h)(App, null), document.body);\n\n/***/ }),\n/* 2 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _utils = __webpack_require__(0);\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar Size = function Size(w, h) {\n  _classCallCheck(this, Size);\n\n  this.w = w;\n  this.h = h;\n};\n\nvar ZoomImage = function () {\n  function ZoomImage(img, offset) {\n    _classCallCheck(this, ZoomImage);\n\n    this.img = img;\n    this.preservedTransform = img.style.transform;\n    this.wrap = null;\n    this.overlay = null;\n    this.offset = offset;\n  }\n\n  _createClass(ZoomImage, [{\n    key: 'forceRepaint',\n    value: function forceRepaint() {\n      var _ = this.img.offsetWidth;\n      return;\n    }\n  }, {\n    key: 'zoom',\n    value: function zoom() {\n      var size = new Size(this.img.naturalWidth, this.img.naturalHeight);\n\n      this.wrap = document.createElement('div');\n      this.wrap.classList.add('zoom-img-wrap');\n      this.img.parentNode.insertBefore(this.wrap, this.img);\n      this.wrap.appendChild(this.img);\n\n      this.img.classList.add('zoom-img');\n      this.img.setAttribute('data-action', 'zoom-out');\n\n      this.overlay = document.createElement('div');\n      this.overlay.classList.add('zoom-overlay');\n      document.body.appendChild(this.overlay);\n\n      this.forceRepaint();\n      var scale = this.calculateScale(size);\n\n      this.forceRepaint();\n      this.animate(scale);\n\n      document.body.classList.add('zoom-overlay-open');\n    }\n  }, {\n    key: 'calculateScale',\n    value: function calculateScale(size) {\n      var maxScaleFactor = size.w / this.img.width;\n\n      var viewportWidth = (0, _utils.windowWidth)() - this.offset;\n      var viewportHeight = (0, _utils.windowHeight)() - this.offset;\n      var imageAspectRatio = size.w / size.h;\n      var viewportAspectRatio = viewportWidth / viewportHeight;\n\n      if (size.w < viewportWidth && size.h < viewportHeight) {\n        return maxScaleFactor;\n      } else if (imageAspectRatio < viewportAspectRatio) {\n        return viewportHeight / size.h * maxScaleFactor;\n      }\n      return viewportWidth / size.w * maxScaleFactor;\n    }\n  }, {\n    key: 'animate',\n    value: function animate(scale) {\n      var imageOffset = (0, _utils.elemOffset)(this.img);\n      var scrollTop = window.pageYOffset;\n\n      var viewportX = (0, _utils.windowWidth)() / 2;\n      var viewportY = scrollTop + (0, _utils.windowHeight)() / 2;\n\n      var imageCenterX = imageOffset.left + this.img.width / 2;\n      var imageCenterY = imageOffset.top + this.img.height / 2;\n\n      var tx = viewportX - imageCenterX;\n      var ty = viewportY - imageCenterY;\n      var tz = 0;\n\n      var imgTr = 'scale(' + scale + ')';\n      var wrapTr = 'translate3d(' + tx + 'px, ' + ty + 'px, ' + tz + 'px)';\n\n      this.img.style.transform = imgTr;\n      this.wrap.style.transform = wrapTr;\n    }\n  }, {\n    key: 'dispose',\n    value: function dispose() {\n      if (this.wrap === null || this.wrap.parentNode === null) {\n        return;\n      }\n      this.img.classList.remove('zoom-img');\n      this.img.setAttribute('data-action', 'zoom');\n\n      this.wrap.parentNode.insertBefore(this.img, this.wrap);\n      this.wrap.parentNode.removeChild(this.wrap);\n\n      document.body.removeChild(this.overlay);\n      document.body.classList.remove('zoom-overlay-transitioning');\n    }\n  }, {\n    key: 'close',\n    value: function close() {\n      var _this = this;\n\n      document.body.classList.add('zoom-overlay-transitioning');\n      this.img.style.transform = this.preservedTransform;\n      if (this.img.style.length === 0) {\n        this.img.removeAttribute('style');\n      }\n      this.wrap.style.transform = 'none';\n\n      (0, _utils.once)(this.img, 'transitionend', function () {\n        _this.dispose();\n        // remove class should happen after dispose. Otherwise,\n        // a new click event could fire and create a duplicate ZoomImage for\n        // the same <img> element.\n        document.body.classList.remove('zoom-overlay-open');\n      });\n    }\n  }]);\n\n  return ZoomImage;\n}();\n\nexports.default = ZoomImage;\n\n/***/ }),\n/* 3 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nexports.default = function (el) {\n  el.addEventListener('click', prepareZoom);\n};\n\nvar _zoomImage = __webpack_require__(2);\n\nvar _zoomImage2 = _interopRequireDefault(_zoomImage);\n\nvar _utils = __webpack_require__(0);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/**\n * Pure JavaScript implementation of zoom.js.\n *\n * Original preamble:\n * zoom.js - It's the best way to zoom an image\n * @version v0.0.2\n * @link https://github.com/fat/zoom.js\n * @license MIT\n *\n * Needs a related CSS file to work. See the README at\n * https://github.com/nishanths/zoom.js for more info.\n *\n * This is a fork of the original zoom.js implementation by @fat.\n * Copyrights for the original project are held by @fat. All other copyright\n * for changes in the fork are held by Nishanth Shanmugham.\n *\n * Copyright (c) 2013 @fat\n * The MIT License. Copyright © 2016 Nishanth Shanmugham.\n */\n\nvar current = null;\nvar offset = 80;\nvar initialScrollPos = -1;\nvar initialTouchPos = -1;\n\nfunction handleScroll() {\n  if (initialScrollPos === -1) {\n    initialScrollPos = window.pageYOffset;\n  }\n\n  var deltaY = Math.abs(initialScrollPos - window.pageYOffset);\n  if (deltaY >= 40) {\n    closeCurrent();\n  }\n}\n\nfunction handleKeyup(e) {\n  if (e.keyCode === 27) {\n    closeCurrent();\n  }\n}\n\nfunction handleTouchStart(e) {\n  var t = e.touches[0];\n  if (t === null) {\n    return;\n  }\n\n  initialTouchPos = t.pageY;\n  e.target.addEventListener('touchmove', handleTouchMove);\n}\n\nfunction handleTouchMove(e) {\n  var t = e.touches[0];\n  if (t === null) {\n    return;\n  }\n\n  if (Math.abs(t.pageY - initialTouchPos) > 10) {\n    closeCurrent();\n    e.target.removeEventListener('touchmove', handleTouchMove);\n  }\n}\n\nfunction handleClick() {\n  closeCurrent();\n}\n\nfunction addCloseListeners() {\n  document.addEventListener('scroll', handleScroll);\n  document.addEventListener('keyup', handleKeyup);\n  document.addEventListener('touchstart', handleTouchStart);\n  document.addEventListener('click', handleClick, true);\n}\n\nfunction removeCloseListeners() {\n  document.removeEventListener('scroll', handleScroll);\n  document.removeEventListener('keyup', handleKeyup);\n  document.removeEventListener('touchstart', handleTouchStart);\n  document.removeEventListener('click', handleClick, true);\n}\n\nfunction closeCurrent(force) {\n  if (current === null) {\n    return;\n  }\n  if (force) {\n    current.dispose();\n  } else {\n    current.close();\n  }\n  removeCloseListeners();\n  current = null;\n}\n\nfunction prepareZoom(e) {\n  if (document.body.classList.contains('zoom-overlay-open')) {\n    return;\n  }\n\n  if (e.metaKey || e.ctrlKey) {\n    window.open(e.target.getAttribute('data-original') || e.target.src, '_blank');\n    return;\n  }\n\n  if (e.target.width >= (0, _utils.windowWidth)() - offset) {\n    return;\n  }\n\n  closeCurrent(true);\n\n  current = new _zoomImage2.default(e.target, offset);\n  current.zoom();\n\n  addCloseListeners();\n}\n\n/***/ }),\n/* 4 */\n/***/ (function(module, exports) {\n\n// removed by extract-text-webpack-plugin\n\n/***/ }),\n/* 5 */,\n/* 6 */,\n/* 7 */\n/***/ (function(module, exports, __webpack_require__) {\n\nmodule.exports = __webpack_require__(1);\n\n\n/***/ })\n],[7]);\n\n\n// WEBPACK FOOTER //\n// client.2a8855fd.js","const windowWidth = () => document.documentElement.clientWidth\nconst windowHeight = () => document.documentElement.clientHeight\n\nconst elemOffset = elem => {\n  const rect = elem.getBoundingClientRect()\n  const docElem = document.documentElement\n  const win = window\n  return {\n    top: rect.top + win.pageYOffset - docElem.clientTop,\n    left: rect.left + win.pageXOffset - docElem.clientLeft\n  }\n}\n\nconst once = (elem, type, handler) => {\n  const fn = e => {\n    e.target.removeEventListener(type, fn)\n    handler()\n  }\n  elem.addEventListener(type, fn)\n}\n\nexport { windowWidth, windowHeight, elemOffset, once }\n\n\n\n// WEBPACK FOOTER //\n// ./src/utils.js","import { render, Component } from 'preact'\nimport zoom from '../src/zoom'\nimport '../css/zoom-image.css'\n\nclass App extends Component {\n  componentDidMount() {\n    zoom(this.img)\n  }\n\n  render() {\n    return (\n      <div class=\"app\">\n        <h1>Just tap the image!</h1>\n        <img width=\"200\" ref={ img => this.img = img } src=\"https://ooo.0o0.ooo/2017/02/11/589ecad7083f4.png\" />\n      </div>\n    )\n  }\n}\n\nrender(<App />, document.body)\n\n\n\n// WEBPACK FOOTER //\n// ./example/index.js","import { elemOffset, once, windowWidth, windowHeight } from './utils'\n\nclass Size {\n  constructor(w, h) {\n    this.w = w\n    this.h = h\n  }\n}\n\nexport default class ZoomImage {\n  constructor(img, offset) {\n    this.img = img\n    this.preservedTransform = img.style.transform\n    this.wrap = null\n    this.overlay = null\n    this.offset = offset\n  }\n\n  forceRepaint() {\n    const _ = this.img.offsetWidth\n    return\n  }\n\n  zoom() {\n    const size = new Size(this.img.naturalWidth, this.img.naturalHeight)\n\n    this.wrap = document.createElement('div')\n    this.wrap.classList.add('zoom-img-wrap')\n    this.img.parentNode.insertBefore(this.wrap, this.img)\n    this.wrap.appendChild(this.img)\n\n    this.img.classList.add('zoom-img')\n    this.img.setAttribute('data-action', 'zoom-out')\n\n    this.overlay = document.createElement('div')\n    this.overlay.classList.add('zoom-overlay')\n    document.body.appendChild(this.overlay)\n\n    this.forceRepaint()\n    const scale = this.calculateScale(size)\n\n    this.forceRepaint()\n    this.animate(scale)\n\n    document.body.classList.add('zoom-overlay-open')\n  }\n\n  calculateScale(size) {\n    const maxScaleFactor = size.w / this.img.width\n\n    const viewportWidth = (windowWidth() - this.offset)\n    const viewportHeight = (windowHeight() - this.offset)\n    const imageAspectRatio = size.w / size.h\n    const viewportAspectRatio = viewportWidth / viewportHeight\n\n    if (size.w < viewportWidth && size.h < viewportHeight) {\n      return maxScaleFactor\n    } else if (imageAspectRatio < viewportAspectRatio) {\n      return (viewportHeight / size.h) * maxScaleFactor\n    }\n    return (viewportWidth / size.w) * maxScaleFactor\n  }\n\n  animate(scale) {\n    const imageOffset = elemOffset(this.img)\n    const scrollTop = window.pageYOffset\n\n    const viewportX = (windowWidth() / 2)\n    const viewportY = scrollTop + (windowHeight() / 2)\n\n    const imageCenterX = imageOffset.left + (this.img.width / 2)\n    const imageCenterY = imageOffset.top + (this.img.height / 2)\n\n    const tx = viewportX - imageCenterX\n    const ty = viewportY - imageCenterY\n    const tz = 0\n\n    const imgTr = `scale(${scale})`\n    const wrapTr = `translate3d(${tx}px, ${ty}px, ${tz}px)`\n\n    this.img.style.transform = imgTr\n    this.wrap.style.transform = wrapTr\n  }\n\n  dispose() {\n    if (this.wrap === null || this.wrap.parentNode === null) {\n      return\n    }\n    this.img.classList.remove('zoom-img')\n    this.img.setAttribute('data-action', 'zoom')\n\n    this.wrap.parentNode.insertBefore(this.img, this.wrap)\n    this.wrap.parentNode.removeChild(this.wrap)\n\n    document.body.removeChild(this.overlay)\n    document.body.classList.remove('zoom-overlay-transitioning')\n  }\n\n  close() {\n    document.body.classList.add('zoom-overlay-transitioning')\n    this.img.style.transform = this.preservedTransform\n    if (this.img.style.length === 0) {\n      this.img.removeAttribute('style')\n    }\n    this.wrap.style.transform = 'none'\n\n    once(this.img, 'transitionend', () => {\n      this.dispose()\n      // remove class should happen after dispose. Otherwise,\n      // a new click event could fire and create a duplicate ZoomImage for\n      // the same <img> element.\n      document.body.classList.remove('zoom-overlay-open')\n    })\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/zoom-image.js","/**\n * Pure JavaScript implementation of zoom.js.\n *\n * Original preamble:\n * zoom.js - It's the best way to zoom an image\n * @version v0.0.2\n * @link https://github.com/fat/zoom.js\n * @license MIT\n *\n * Needs a related CSS file to work. See the README at\n * https://github.com/nishanths/zoom.js for more info.\n *\n * This is a fork of the original zoom.js implementation by @fat.\n * Copyrights for the original project are held by @fat. All other copyright\n * for changes in the fork are held by Nishanth Shanmugham.\n *\n * Copyright (c) 2013 @fat\n * The MIT License. Copyright © 2016 Nishanth Shanmugham.\n */\n\nimport ZoomImage from './zoom-image'\nimport { windowWidth } from './utils'\n\nlet current = null\nconst offset = 80\nlet initialScrollPos = -1\nlet initialTouchPos = -1\n\nfunction handleScroll() {\n  if (initialScrollPos === -1) {\n    initialScrollPos = window.pageYOffset\n  }\n\n  const deltaY = Math.abs(initialScrollPos - window.pageYOffset)\n  if (deltaY >= 40) {\n    closeCurrent()\n  }\n}\n\nfunction handleKeyup(e) {\n  if (e.keyCode === 27) {\n    closeCurrent()\n  }\n}\n\nfunction handleTouchStart(e) {\n  const t = e.touches[0]\n  if (t === null) {\n    return\n  }\n\n  initialTouchPos = t.pageY\n  e.target.addEventListener('touchmove', handleTouchMove)\n}\n\nfunction handleTouchMove(e) {\n  const t = e.touches[0]\n  if (t === null) {\n    return\n  }\n\n  if (Math.abs(t.pageY - initialTouchPos) > 10) {\n    closeCurrent()\n    e.target.removeEventListener('touchmove', handleTouchMove)\n  }\n}\n\nfunction handleClick() {\n  closeCurrent()\n}\n\nfunction addCloseListeners() {\n  document.addEventListener('scroll', handleScroll)\n  document.addEventListener('keyup', handleKeyup)\n  document.addEventListener('touchstart', handleTouchStart)\n  document.addEventListener('click', handleClick, true)\n}\n\nfunction removeCloseListeners() {\n  document.removeEventListener('scroll', handleScroll)\n  document.removeEventListener('keyup', handleKeyup)\n  document.removeEventListener('touchstart', handleTouchStart)\n  document.removeEventListener('click', handleClick, true)\n}\n\nfunction closeCurrent(force) {\n  if (current === null) {\n    return\n  }\n  if (force) {\n    current.dispose()\n  } else {\n    current.close()\n  }\n  removeCloseListeners()\n  current = null\n}\n\nfunction prepareZoom(e) {\n  if (document.body.classList.contains('zoom-overlay-open')) {\n    return\n  }\n\n  if (e.metaKey || e.ctrlKey) {\n    window.open((e.target.getAttribute('data-original') || e.target.src), '_blank')\n    return\n  }\n\n  if (e.target.width >= windowWidth() - offset) {\n    return\n  }\n\n  closeCurrent(true)\n\n  current = new ZoomImage(e.target, offset)\n  current.zoom()\n\n  addCloseListeners()\n}\n\nexport default function (el) {\n  el.addEventListener('click', prepareZoom)\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/zoom.js"],"sourceRoot":""}